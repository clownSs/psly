<!DOCTYPE html>
<html>
	<head> 
		<meta charset="utf-8">
		<title>平山楼宇-数据统计</title>
		<link rel="stylesheet" type="text/css" href="lib/layui-v2.4.5/layui-v2.4.5/layui/css/layui.css" />
		<link rel="stylesheet" type="text/css" href="css/resetcss.css"/>
		<link rel="stylesheet" type="text/css" href="css/sjtj.css"/>
		<link rel="stylesheet" type="text/css" href="css/icons.css"/>
		<script src="http://libs.baidu.com/jquery/2.1.4/jquery.min.js"></script>
		<script src="lib/layui-v2.4.5/layui-v2.4.5/layui/layui.js"></script>
		<script src="https://cdn.bootcss.com/echarts/4.2.1-rc1/echarts-en.common.min.js"></script>
		<script src='http://api.map.baidu.com/api?v=2.0&ak=1pSTowk3vMReXCQA08ypPGfGoOaZI0qk'></script>
		<script type="text/javascript" src="http://api.map.baidu.com/library/Heatmap/2.0/src/Heatmap_min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
	</head>
	<body> 
		
		<div id="conBox">
			
			<div id="allmap" style="width: 100%;"></div>
			
			<section id="main">
				<header id="header" class="clearfix">
					<div class="header1">
						<img class="logo" src="./images/school_icon.png" alt="">
						<h1 class="title1">平山楼宇-</h1>
						<h2 class="title2">数据统计</h2>
					</div>
					<div class="header2 ">
						<ul class="titleImg clearfix">
							<li><span class="icon-statistics nav-top active-icon" data-href="psly_sjtj.html"></span></li>
							<li><span class="icon-equipment nav-top " data-href="psly_sbkz.html"></li>
							<li><span class="icon-camera nav-top" data-href="psly_spfx.html"></li>
							<li><span class="icon-incident nav-top " data-href="psly_rcsj.html"></li>
							<li><span class="icon-emergency_events nav-top" data-href="psly_afsj.html"></li>
							<li><span class="icon-location nav-top " data-href="psly_tsdw.html"></li>
							<li><span class="icon-park nav-top" data-href="psly_tcc.html"></li>
						</ul>
					</div>
					<div class="header3">
						<div class="showBig" @click="fullScreen"></div>
						<div class="maxSearch_icon"></div>
						<div class="Setting_icon"></div>
						<div class="time">2019年6月6日 星期四 农历五月初四</div>
					</div>
				</header>
			
				<div id="content" class="clearfix">
				
					<section id="left">
						<ul class="item" id="itemUl1">
							<li>
								<h3 class="item1">评分指数</h3>
								<div class="item3"style="width: 100%;height:70px;">
									<ul class="clearfix">
										<li>总分 <span> 98</span></li>
										<li id="pieChart1"></li>
										<li id="pieChart2"></li>
										<li id="pieChart3"></li>
										<li id="pieChart4"></li>
									</ul>
									<ul>
										<li></li>
										<li>满意度</li>
										<li>舒适度</li>
										<li>安全度</li>
										<li>整洁度</li>
									</ul>
								</div>
							</li>
							<li>
								<h3 class="item1">到访人员</h3>
								<div class="item2">
									<ul class="clearfix">
										<li>12000<h3>月到访（人）</h3></li>
										<li>800<h3>今日到访（人）</h3></li>
									</ul>
								</div>
								<div class="item3" id="echartsL-1" style="width: 100%; height: 120px;"></div>
							</li>
							<li class="energy">
								<h3 class="item1">节能统计</h3>
								<div class="item3" style="width: 100%; height: 120px;">
									<div>
										<img src="images/echarts_1.png" style="width: 120px;height: 120px;"/>
									</div>
									<div>
										<ul>
											<li><span></span> 总节能潜力</li>
											<li><span></span> 供暖和制冷</li>
											<li><span></span> 照明</li>
											<li><span></span> 二氧化碳排量</li>
										</ul>
									</div>
								</div>
							</li>
							<li class="Iecharts">
								<h3 class="item1">水务统计</h3>
								<div class="item2">
									<div class="Switch">
										<span>
											<form class="layui-form" action="">
												<input type="checkbox" name="zzz" lay-skin="switch" lay-text="月|天">
											</form>
										</span>
									</div>
									<ul class="clearfix">
										<li>1100<h3>月用水（顿）</h3></li>
										<li>36<h3>今日用水（顿）</h3></li>
									</ul>
								</div>
								<div class="item3" style="width: 100%;height: 100px;">
									<div id="echartsL-2"></div>
									<div>
										<ul>
											<li>0.5%</li>
											<li>0.1%</li>
											<li>2%</li>
										</ul>
										<ul>
											<li>70% 住房</li>
											<li>20% 商铺</li>
											<li>5% 公用</li>
										</ul>
									</div>
									<div>
										<img src="images/echarts_2.png" width="100%" height="100%" />
									</div>
								</div>
							</li>
							<li class="Iecharts">
								<h3 class="item1">电量统计</h3>
								<div class="item2">
									<div class="Switch">
										<span>
											<form class="layui-form" action="">
												<input type="checkbox" name="zzz" lay-skin="switch" lay-text="月|天">
											</form>
										</span>
									</div>
									<ul class="clearfix">
										<li>166000<h3>月用电（KWh）</h3></li>
										<li>5200<h3>今日用水（KWh）</h3></li>
									</ul>
								</div>
								<div class="item3" style="width: 100%;height: 100px;">
									<div id="echartsL-3"></div>
									<div>
										<ul>
											<li>0.5%</li>
											<li>0.1%</li>
											<li>2%</li>
										</ul>
										<ul>
											<li>70% 住房</li>
											<li>20% 商铺</li>
											<li>5% 公用</li>
										</ul>
									</div>
									<div>
										<img src="images/echarts_2.png" width="100%" height="100%" />
									</div>
								</div>
							</li>
						</ul>
						<span class="btnLeft" id="btnLeft"></span>
					</section>
				
					<section id="footer">
						<div id="parking">
							<ul class="clearfix">
								<li><span>800</span> <br />总车位</li>
								<li><span>720</span> <br />已用车位</li>
								<li><span>80</span> <br />剩余车位</li>
							</ul>
						</div>
						<ul class="item clearfix" id="itemUl3">
							<li class="company">
								<h3 class="item1">企业统计</h3>
								<div class="item2 clearfix">
									<span>3<h3>上市企业</h3></span>
									<span>100<h3>企业总数</h3></span>
								</div>
								<div class="item3 clearfix"style="width: 100%;height:100px;">
									<div id="echartsL-4"></div>
									<div>
										<ul>
											<li>0-50人&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>55%</span></li>
											<li>51-100人&nbsp;&nbsp;&nbsp;<span>15%</span></li>
											<li>101-150人&nbsp;&nbsp;<span>25%</span></li>
											<li>150-200人&nbsp;&nbsp;<span>11%</span></li>
											<li>200以上&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>7%</span></li>
										</ul>
									</div>
								</div>
							</li>
							<li>
								<h3 class="item1">热点统计</h3>
								<div class="item3" id="echartsF-1" style="width: 100%;height:139px;"></div>
							</li>
						</ul>
						<span class="btnFooter" id="btnFooter"></span>
					</section>
					
					<section id="right">
						<ul class="item" id="itemUl2">
							<li class="costs">
								<h3 class="item1">管理费统计</h3>
								<div class="item3 clearfix"style="width: 100%;height:50px;">
									<div>
										<span>2.40</span> 元/平方
										<h3>管理费单价</h3>
									</div>
									<div>
										<div> <span></span> </div>  已收账 <span>80%</span>
										<div> <span></span> </div>  未收账 <span>20%</span>
									</div>
								</div>
							</li>
							<li>
								<h3 class="item1">新闻通知</h3>
								
								<div class="item3 clearfix">
									<div>
										<ul>
											<li v-for="(e, index) in pub" v-if="index < 7"  :key="index">
												<span :class="{top3:(index+1) < 4}">{{index+1}}</span>
												<span>{{e.pubTitle}}</span>
												<span>{{e.pubCt|dateStr1}}</span>
											</li>
										</ul>
									</div>
									<div>
										<ul>
											<li v-for="(e, index) in pub" v-if="index < 14 && index > 6"  :key="index">
												<span :class="{top3:(index+1) < 4}">{{index+1}}</span>
												<span>{{e.pubTitle}}</span>
												<span>{{e.pubCt |dateStr1}}</span>
											</li>
										</ul>
									</div>
								</div>
							</li>
							<li class="weather">
								<h3 class="item1">天气</h3>
								<div class="item3 clearfix">
									<div>
										<div>
											<img src="images/weather-4.png" />
										</div>
										<div>25℃</div>
										<div>无持续风向微风</div>
									</div>
									<div>
										<div>
											<ul class="clearfix">
												<li>星期四<br /><span>5月50</span></li>
												<li>星期四<br /><span>5月50</span></li>
												<li>星期四<br /><span>5月50</span></li>
												<li>星期四<br /><span>5月50</span></li>
											</ul>
										</div>
										<div>
											<ul class="clearfix">
												<li>
													<img src="images/weather-2.png" />
												</li>
												<li>
													<img src="images/weather-3.png" />
												</li>
												<li>
													<img src="images/weather-2.png" />
												</li>
												<li>
													<img src="images/weather-1.png" />
												</li>
											</ul>
										</div>
										<div>
											<ul class="clearfix">
												<li>20℃<br /><span>16℃</span></li>
												<li>20℃<br /><span>16℃</span></li>
												<li>20℃<br /><span>16℃</span></li>
												<li>20℃<br /><span>16℃</span></li>
											</ul>
										</div>
									</div>
								</div>
							</li>
							<li>
								<h3 class="item1">设备管理</h3>
								<div class="item2">
									<ul class="clearfix">
										<li>830<h3>总设备（台）</h3></li>
										<li>300<h3>智慧路灯（台）</h3></li>
									</ul>
								</div>
								<div class="item3" style="width: 100%;height: 100px;">
									<ul class="echartsList clearfix">
										<li id="pieChartR1"></li>
										<li id="pieChartR2"></li>
										<li id="pieChartR3"></li>
										<li id="pieChartR4"></li>
									</ul>
								</div>
							</li>
							<li class="airQuality">
								<h3 class="item1">空气质量</h3>
								<div class="item3 clearfix" style="width: 100%;height: 139px;">
									<div id="pieChartR5"></div>
									<div>
										<ul>
											<li>
												<div>
													<span>PM2.5 <h3>μg/m²</h3> </span>
													<span>114</span>
												</div>
												<div class="line"></div>
											</li>
											<li>
												<div>
													<span>O₂ <h3>μg/m²</h3> </span>
													<span>114</span>
												</div>
												<div class="line"></div>
											</li>
											<li>
												<div>
													<span>NO₂ <h3>μg/m²</h3> </span>
													<span>114</span>
												</div>
												<div class="line"></div>
											</li>
										</ul>
									</div>
									<div>
										<ul>
											<li>
												<div>
													<span>PM10 <h3>μg/m²</h3> </span>
													<span>114</span>
												</div>
												<div class="line"></div>
											</li>
											<li>
												<div>
													<span>SO₂ <h3>μg/m²</h3> </span>
													<span>114</span>
												</div>
												<div class="line"></div>
											</li>
											<li>
												<div>
													<span>CO₂ <h3>μg/m²</h3> </span>
													<span>114</span>
												</div>
												<div class="line"></div>
											</li>
										</ul>
									</div>
									<span>良</span>
								</div>
							</li>
						</ul>
						<span class="btnRight" id="btnRight"></span>
					</section>
					
				</div>
			</section>
		</div>
		<script>
			window.onload = function() {
				
				layui.use('form', function(){
				  var form = layui.form;
				  form.render();
				
				});
				
				
				// 头部导航
				var navTops = document.getElementsByClassName('nav-top')
				for(var i = 0; i < navTops.length; i++) {
					navTops[i].index = i
					navTops[i].onclick = function() {
						for(var i = 0; i < navTops.length; i++) {
							navTops[i].classList.remove('active-icon')
						}
						this.classList.add('active-icon')
						window.location.href = this.dataset.href;
					}
				}
				
				var right = document.getElementById('right')
				var rw = right.offsetWidth
				var left = document.getElementById('left')
				var lw = left.offsetWidth
				
				
				// 左边显示隐藏
				var btnLeft = document.getElementById('btnLeft')
				var itemUl1 = document.getElementById('itemUl1')
				var lw = left.offsetWidth
				
				var clickLeft = true
				btnLeft.onclick = function() {
					console.log("左边"+clickLeft)
					if(clickLeft) {
						itemUl1.style.width = lw - 50 + 'px'
						itemUl1.style.opacity = 0
						btnLeft.style.right = lw - 12 + 'px'
						clickLeft = false
					} else {
						itemUl1.style.opacity = 1
						left.style.width = '24%'
						itemUl1.style.width = '100%'
						btnLeft.style.right = -25 + 'px'
						clickLeft = true
					}
				}
				
				// 右边显示隐藏
				var btnRight = document.getElementById('btnRight')
				var itemUl2 = document.getElementById('itemUl2')
				var right = document.getElementById('right')
				var rw = right.offsetWidth
				var clickRight = true
				btnRight.onclick = function() {
					console.log("右边"+clickRight)
					if(clickRight) {
						right.style.width = rw - 50 + 'px'
						itemUl2.style.opacity = 0
						btnRight.style.left = rw - 60 + 'px'
						clickRight = false
					} else {
						itemUl2.style.opacity = 1
						right.style.width = '24%'
						btnRight.style.left = -25 + 'px'
						clickRight = true
					}
				}
				
				// 底部显示隐藏
				var btnFooter = document.getElementById('btnFooter')
				var itemUl3 = document.getElementById('itemUl3')
				var footer = document.getElementById('footer')
				var parking  = document.getElementById('parking')
				footer.style.height = itemUl3.offsetHeight + 'px'
				var fh = footer.offsetHeight
				footer.style.height = itemUl3.offsetHeight + 'px'
				var clickFooter = true
				btnFooter.onclick = function() {
					console.log('底部'+clickFooter)
					if(clickFooter) {
						footer.style.height = 15 + 'px'
						parking.style.height = parking.offsetHeight - 30 + 'px'
						itemUl3.style.opacity = 0
						parking.style.opacity = 0
						clickFooter = false
					} else {
						footer.style.height = fh + 'px'
						parking.style.height = parking.offsetHeight + 30 + 'px'
						itemUl3.style.opacity = 1
						parking.style.opacity = 1
						clickFooter = true
					}
				}
				
				initMapHeight() // 设置高时选择左右侧较高的一侧
				function initMapHeight() {
					var mainNode = document.getElementById('main')
					var allmap = document.getElementById('allmap')
					var rh = right.offsetHeight
					var lh = left.offsetHeight
					if(lh >= rh) {
						allmap.style.height = lh + 65 + 'px'
					} else {
						allmap.style.height = rh + 65 + 'px'
					}
				}
				
				
				
				/** 百度地图开始 踩坑1：百度地图必须放在vue之后，不然无法渲染数据 **/
				/** 百度地图开始 踩坑4：div必须要display: inline-block;才能正常显示 **/
				initMap()
				function initMap() {
					var point = new BMap.Point(106.374814,29.60782);
					var map = new BMap.Map("allmap",{minZoom:6,maxZoom:100,mapType:BMAP_HYBRID_MAP,enableMapClick:false});    // 创建Map实例
					map.centerAndZoom(point, 17);  // 初始化地图,设置中心点坐标和地图级别
					
					/**添加地图类型控件*/
					map.addControl(new BMap.MapTypeControl({
						mapTypes:[
							BMAP_NORMAL_MAP,
							BMAP_HYBRID_MAP
						]}));	  
					map.enableScrollWheelZoom(true);     //开启鼠标滚轮缩放
					/**添加地图类型控件结束*/
					
					/** 添加圆形遮罩 */
					var circle = new BMap.Circle(point,5000000,{strokeColor:"blue", fillColor: "#0c1e46", fillOpacity: 0.5,strokeWeight:2, strokeOpacity:0.5});
					map.addOverlay(circle);            //增加圆
					circle.disableMassClear() //禁止清除
					/** 添加圆形遮罩结束 */
					
					/*** 自定义控件*/
					// 顶部导航条
					addTitle(); 
					function addTitle() {
						function zoomControl() {
						  this.defaultAnchor = BMAP_ANCHOR_TOP_RIGHT;
						  this.defaultOffset = new BMap.Size(0, 0);
						}
									
						// 集成Control类
						zoomControl.prototype = new BMap.Control();
						// 实现initialize方法
						zoomControl.prototype.initialize = function (map) {
						  // 创建一个DOM元素
						  var div = document.getElementById("header");
									
						  // 添加DOM元素到地图中
						  map.getContainer().appendChild(div);
						  return div;
						}
						// 创建控件
						var myZoomCtrl = new zoomControl();
						map.addControl(myZoomCtrl);
					  }// 自定义控件添加完成
					
					addLeft();
					function addLeft() {
						// 定义一个控件类,即function
						function zoomControl() {
							// 默认停靠位置和偏移量
							this.defaultAnchor = BMAP_ANCHOR_TOP_LEFT;
							this.defaultOffset = new BMap.Size(0, 65);
						}
					
						// 集成Control类
						zoomControl.prototype = new BMap.Control();
						// 实现initialize方法
						zoomControl.prototype.initialize = function (map) {
							// 创建一个DOM元素
							var div = document.getElementById("left");
							
							// 添加DOM元素到地图中
							map.getContainer().appendChild(div);
							return div;
						}
						 // 创建控件
						var myZoomCtrl = new zoomControl();
						map.addControl(myZoomCtrl);
					}
					
					addRight();
					function addRight() {
						// 定义一个控件类,即function
						function zoomControl() {
							// 默认停靠位置和偏移量
							this.defaultAnchor = BMAP_ANCHOR_BOTTOM_RIGHT;
							this.defaultOffset = new BMap.Size(0, 0);
						}
					
						// 集成Control类
						zoomControl.prototype = new BMap.Control();
						// 实现initialize方法
						zoomControl.prototype.initialize = function (map) {
							// 创建一个DOM元素
							var div = document.getElementById("right");
							
							// 添加DOM元素到地图中
							map.getContainer().appendChild(div);
							return div;
						}
						 // 创建控件
						var myZoomCtrl = new zoomControl();
						map.addControl(myZoomCtrl);
					}
					
					addFooter()
					function addFooter() {
						// 定义一个控件类,即function
						function zoomControl() {
							// 默认停靠位置和偏移量
							this.defaultAnchor = BMAP_ANCHOR_BOTTOM_LEFT;
							this.defaultOffset = new BMap.Size(lw + 23, 0);
						}
					
						// 集成Control类
						zoomControl.prototype = new BMap.Control();
						// 实现initialize方法
						zoomControl.prototype.initialize = function (map) {
							// 创建一个DOM元素
							var div = document.getElementById("footer");
							
							// 添加DOM元素到地图中
							map.getContainer().appendChild(div);
							return div;
						}
						 // 创建控件
						var myZoomCtrl = new zoomControl();
						map.addControl(myZoomCtrl);
					}
					
					/** 自定义控件结束 **/
					
					var opts = {
						width:320,     // 信息窗口宽度
						height: 170,     // 信息窗口高度
						enableMessage: true//设置允许信息窗发送短息
					};
					var opts1 = {
						width:320,     // 信息窗口宽度
						height: 250,     // 信息窗口高度
						enableMessage: true//设置允许信息窗发送短息
					};
					
					function Obj(point, str, label, icon) {
						this.point = point;
						this.str = str;
						this.label = label;
						this.icon = icon;
					}
					
					/** 模板1 */
					function tlp1(d) {
						return '<div id="moban" style ="width:298px;height:133px; padding: 25px 10px 10px 10px;position: absolute;bottom: 0;left:0px; border: 1px solid #00d585;border-radius:10px;">' +
							'<table style="color: #fff; font-size: 14px; margin-left: 20px">' +
							'<tr><td>异常简述：</td><td id="errsValue">'+d.name+'</td></tr>' +
							'<tr><td>上报设备：</td><td>'+d.name+'</td></tr>' +
							'<tr><td>发生时间：</td><td>'+d.name+'</td></tr>' +
							'</table>' +
							'</div>'
					}
					/** 模板2 */
					function tlp2(d) {
						return '<div id="moban" style ="width:298px;height:213px; padding: 25px 10px 10px 10px;position: absolute;bottom: 0;left:0px;border: 1px solid #fd9d02;border-radius:10px;">' +
							'<table style="color: #fff; font-size: 14px; margin-left: 20px">' +
							'<tr><td>异常简述：</td><td id="errsValue">'+d.name+'</td></tr>' +
							'<tr><td>上报设备：</td><td>'+d.name+'</td></tr>' +
							'<tr><td>发生时间：</td><td>'+d.name+'</td></tr>' +
							'</table>' +
							'</div>'
					}
					
					//创建自定义覆盖物图标
					var myIcon = new BMap.Icon("./images/mapIcon/combustible_gas2.png", new BMap.Size(50,50));
					var myIcon1 = new BMap.Icon("./images/mapIcon/guard_people2.png", new BMap.Size(50,50));
					
					var d = {
						id : 1,
						name: '模板测试1'
					}
					var d1 = {
						id : 2,
						name: '模板测试2'
					}
					
					var data_1 = [];
					data_1.push(new Obj(point, tlp1(d), "", myIcon));
					addMarker(data_1,opts)
					
					var marker2 = new BMap.Marker(new BMap.Point(106.377814,29.60782),{icon:myIcon1});  // 创建标注
					map.addOverlay(marker2);
					// marker2.setAnimation(BMAP_ANIMATION_BOUNCE); //跳动的动画
					addClickHandler(tlp2(d1), marker2, opts1);
					
					 //批量添加Marker并添加显示框
					 function addMarker(data_info, opts) {
						for (var i = 0; i < data_info.length; i++) {
						  var marker = new BMap.Marker(data_info[i].point);
						  marker.setIcon(data_info[i].icon);
						  var content = data_info[i].str;
						  if (data_info[i].label) {
							marker.setLabel(new BMap.Label(data_info[i].label, {offset: new BMap.Size(20, -10)}));
						  }
						  map.addOverlay(marker);
						  marker.setAnimation(BMAP_ANIMATION_BOUNCE)
						  addClickHandler(content, marker, opts);
						}
					  }
				
					  function addClickHandler(content, marker, opts) {
						marker.addEventListener("click", function (e) {
							openInfo(content, e, opts)
						  }
						);
					  }
				
					  function openInfo(content, e, opts) {
						var p = e.target;
						var point = new BMap.Point(p.getPosition().lng, p.getPosition().lat);
						var infoWindow = new BMap.InfoWindow(content, opts);  // 创建信息窗口对象
						p.openInfoWindow(infoWindow, point); //开启信息窗口
						map.panTo(point, true)
					  }
					  
				}
				/** 百度地图结束 **/
				
				
				initPieCharts('pieChart1', 60, 10, '#FE9D01', '#553F27')
				initPieCharts('pieChart2', 60, 8, '#095E73', '#01FFFF')
				initPieCharts('pieChart3', 60, 30, '#0082FE', '#093773')
				initPieCharts('pieChart4', 60, 4, '#4DA7FD', '#1E4070')
				initPieCharts('pieChartR5', 60, 92, '#4DA7FD', '#1E4070')
				function initPieCharts(id, count1, count2, color1, color2) {
					var myChart = echarts.init(document.getElementById(id));
					var Collagen = Math.round((count2-count1)/count2*100)
					var option = {
						grid: { // 设置图形大小
							left: '3%',
							right: '4%',
							bottom: '3%',
							top: '20%',
							containLabel: true
						},
						tooltip: {},
						color:[color1, color2],
						graphic: {
							type: 'text',
							left: '40%',
							top: '45%',
							style: {
								text: [
									count2
								].join('\n'),
								textAlign: 'center',
								fill: '#cccccc',
								font: '10px "STHeiti", sans-serif'
							}
						},
				
						series: [
							{
								// name:'',
								type:'pie',
								radius: ['50%', '70%'],
								avoidLabelOverlap: false,
								label: {
									normal: {
										show: false,
										position: 'center'
									},
									emphasis: {
										show: true,
										textStyle: {
											fontSize: '30',
											fontWeight: 'bold'
										}
									}
								},
				
								data:[
									{value: count1},
									{value: count2}
								]
							}
						]
					};
					myChart.setOption(option);
				}
			
			
				var myChart1 = '';
				var myChart2 = '';
				var myChart3 = '';
				var myChart4 = '';
				
				// 初始化echarts
				initEchartsL1('echartsL-1')
				function initEchartsL1(e) {
					myChart1 = echarts.init(document.getElementById(e));
					var option = {
						color: ['#0169c8'],
						grid: { // 设置图形大小
							left: '3%',
							right: '4%',
							bottom: '3%',
							top: '20%',
							containLabel: true
						},
						tooltip: { // 鼠标移上去显示信息
							trigger: 'axis'
						},
						xAxis: {
							type: 'category',
							boundaryGap: false,
							data: ['0','4:00', '8:00', '12:00', '16:00', '20:00', '24:00'],
							axisLabel: {
								textStyle: {
									color: '#fff',//坐标值得具体的颜色
							 
								}
							}
						},
						yAxis: {
							type: 'value',
							axisLabel: {
							   textStyle: {
								   color: '#fff'
							   }
						   }
						},
						 series: [{
							data: [20, 332, 601, 934, 1290, 820, 900],
							type: 'line',
							areaStyle: {}
						}]
					}
					myChart1.setOption(option)
				}
				
				initEchartsL2('echartsL-2')
				initEchartsL2('echartsL-3')
				function initEchartsL2(e) {
					myChart2 = echarts.init(document.getElementById(e));
					var option = {
						grid: { // 设置图形大小
							left: '3%',
							right: '4%',
							bottom: '3%',
							top: '20%',
							containLabel: true
						},
						tooltip: { // 鼠标移上去显示信息
							trigger: 'axis'
						},
						xAxis: {
							type: 'category',
							boundaryGap: false,
							data: ['0','4:00', '8:00', '12:00', '16:00', '20:00', '24:00'],
							axisLabel: {
								textStyle: {
									color: '#fff',//坐标值得具体的颜色
							 
								}
							}
						},
						yAxis: {
							type: 'value',
							axisLabel: {
							   textStyle: {
								   color: '#fff'
							   }
						   }
						},
						 series: [{
							data: [20, 332, 601, 934, 1290, 820, 900],
							type: 'line',
						}]
					}
					myChart2.setOption(option)
				}
				
				
				initEchartsL3('echartsL-4')
				function initEchartsL3(e) {
					myChart3 = echarts.init(document.getElementById(e));
					var option = {
						grid: { // 设置图形大小
							left: '3%',
							right: '4%',
							bottom: '3%',
							top: '20%',
							containLabel: true
						},
						tooltip: { // 鼠标移上去显示信息
							trigger: 'axis'
						},
						xAxis: {
							type: 'category',
							boundaryGap: false,
							data: ['0','4:00', '8:00', '12:00', '16:00', '20:00', '24:00'],
							axisLabel: {
								textStyle: {
									color: '#fff',//坐标值得具体的颜色
							 
								}
							}
						},
						yAxis: {
							type: 'value',
							axisLabel: {
							   textStyle: {
								   color: '#fff'
							   }
						   }
						},
						 series: [{
							data: [20, 332, 601, 934, 1290, 820, 900],
							type: 'line',
							smooth: true,
							areaStyle: {}
						}]
					}
					myChart3.setOption(option)
				}
				
				initPieChartsR('pieChartR1', 60, 10, '#FE9D01', '#553F27','运行')
				initPieChartsR('pieChartR2', 60, 8, '#095E73', '#01FFFF','待机')
				initPieChartsR('pieChartR3', 60, 30, '#0082FE', '#093773','故障')
				initPieChartsR('pieChartR4', 60, 4, '#4DA7FD', '#1E4070','维修')
				function initPieChartsR(id, count1, count2, color1, color2,content) {
					var myChart = echarts.init(document.getElementById(id));
					var Collagen = Math.round((count2-count1)/count2*100)
					var option = {
						grid: { // 设置图形大小
							left: '3%',
							right: '4%',
							bottom: '3%',
							top: '20%',
							containLabel: true
						},
						tooltip: {},
						color:[color1, color2],
						graphic: {
							type: 'text',
							left: '36%',
							top: '40%',
							style: {
								text: [
									count2+'%',
									content
								].join('\n'),
								textAlign: 'center',
								fill: '#cccccc',
								font: '10px "STHeiti", sans-serif'
							}
						},
				
						series: [
							{
								// name:'',
								type:'pie',
								radius: ['40%', '70%'],
								avoidLabelOverlap: false,
								label: {
									normal: {
										show: false,
										position: 'center'
									},
									emphasis: {
										show: true,
										textStyle: {
											fontSize: '30',
											fontWeight: 'bold'
										}
									}
								},
				
								data:[
									{value: count1},
									{value: count2}
								]
							}
						]
					};
					myChart.setOption(option);
				}
				
				
				initHeatMap()
				function initHeatMap() {
					
					var map = new BMap.Map("echartsF-1");          // 创建地图实例
				
					var point = new BMap.Point(116.418261, 39.921984);
					map.centerAndZoom(point, 14);             // 初始化地图，设置中心点坐标和地图级别
					map.enableScrollWheelZoom(); // 允许滚轮缩放
				  
					var points =[
					{"lng":116.418261,"lat":39.921984,"count":50},
					{"lng":116.423332,"lat":39.916532,"count":51},
					{"lng":116.419787,"lat":39.930658,"count":15},
					{"lng":116.418455,"lat":39.920921,"count":40},
					{"lng":116.418843,"lat":39.915516,"count":100},
					{"lng":116.42546,"lat":39.918503,"count":6},
					{"lng":116.423289,"lat":39.919989,"count":18},
					{"lng":116.418162,"lat":39.915051,"count":80},
					{"lng":116.422039,"lat":39.91782,"count":11},
					{"lng":116.41387,"lat":39.917253,"count":7},
					{"lng":116.41773,"lat":39.919426,"count":42},
					{"lng":116.421107,"lat":39.916445,"count":4},
					{"lng":116.417521,"lat":39.917943,"count":27},
					{"lng":116.419812,"lat":39.920836,"count":23},
					{"lng":116.420682,"lat":39.91463,"count":60},
					{"lng":116.415424,"lat":39.924675,"count":8},
					{"lng":116.419242,"lat":39.914509,"count":15},
					{"lng":116.422766,"lat":39.921408,"count":25},
					{"lng":116.421674,"lat":39.924396,"count":21},
					{"lng":116.427268,"lat":39.92267,"count":1},
					{"lng":116.417721,"lat":39.920034,"count":51},
					{"lng":116.412456,"lat":39.92667,"count":7},
					{"lng":116.420432,"lat":39.919114,"count":11},
					{"lng":116.425013,"lat":39.921611,"count":35},
					{"lng":116.418733,"lat":39.931037,"count":22},
					{"lng":116.419336,"lat":39.931134,"count":4},
					{"lng":116.413557,"lat":39.923254,"count":5},
					{"lng":116.418367,"lat":39.92943,"count":3},
					{"lng":116.424312,"lat":39.919621,"count":100},
					{"lng":116.423874,"lat":39.919447,"count":87},
					{"lng":116.424225,"lat":39.923091,"count":32},
					{"lng":116.417801,"lat":39.921854,"count":44},
					{"lng":116.417129,"lat":39.928227,"count":21},
					{"lng":116.426426,"lat":39.922286,"count":80},
					{"lng":116.421597,"lat":39.91948,"count":32},
					{"lng":116.423895,"lat":39.920787,"count":26},
					{"lng":116.423563,"lat":39.921197,"count":17},
					{"lng":116.417982,"lat":39.922547,"count":17},
					{"lng":116.426126,"lat":39.921938,"count":25},
					{"lng":116.42326,"lat":39.915782,"count":100},
					{"lng":116.419239,"lat":39.916759,"count":39},
					{"lng":116.417185,"lat":39.929123,"count":11},
					{"lng":116.417237,"lat":39.927518,"count":9},
					{"lng":116.417784,"lat":39.915754,"count":47},
					{"lng":116.420193,"lat":39.917061,"count":52},
					{"lng":116.422735,"lat":39.915619,"count":100},
					{"lng":116.418495,"lat":39.915958,"count":46},
					{"lng":116.416292,"lat":39.931166,"count":9},
					{"lng":116.419916,"lat":39.924055,"count":8},
					{"lng":116.42189,"lat":39.921308,"count":11},
					{"lng":116.413765,"lat":39.929376,"count":3},
					{"lng":116.418232,"lat":39.920348,"count":50},
					{"lng":116.417554,"lat":39.930511,"count":15},
					{"lng":116.418568,"lat":39.918161,"count":23},
					{"lng":116.413461,"lat":39.926306,"count":3},
					{"lng":116.42232,"lat":39.92161,"count":13},
					{"lng":116.4174,"lat":39.928616,"count":6},
					{"lng":116.424679,"lat":39.915499,"count":21},
					{"lng":116.42171,"lat":39.915738,"count":29},
					{"lng":116.417836,"lat":39.916998,"count":99},
					{"lng":116.420755,"lat":39.928001,"count":10},
					{"lng":116.414077,"lat":39.930655,"count":14},
					{"lng":116.426092,"lat":39.922995,"count":16},
					{"lng":116.41535,"lat":39.931054,"count":15},
					{"lng":116.413022,"lat":39.921895,"count":13},
					{"lng":116.415551,"lat":39.913373,"count":17},
					{"lng":116.421191,"lat":39.926572,"count":1},
					{"lng":116.419612,"lat":39.917119,"count":9},
					{"lng":116.418237,"lat":39.921337,"count":54},
					{"lng":116.423776,"lat":39.921919,"count":26},
					{"lng":116.417694,"lat":39.92536,"count":17},
					{"lng":116.415377,"lat":39.914137,"count":19},
					{"lng":116.417434,"lat":39.914394,"count":43},
					{"lng":116.42588,"lat":39.922622,"count":27},
					{"lng":116.418345,"lat":39.919467,"count":8},
					{"lng":116.426883,"lat":39.917171,"count":3},
					{"lng":116.423877,"lat":39.916659,"count":34},
					{"lng":116.415712,"lat":39.915613,"count":14},
					{"lng":116.419869,"lat":39.931416,"count":12},
					{"lng":116.416956,"lat":39.925377,"count":11},
					{"lng":116.42066,"lat":39.925017,"count":38},
					{"lng":116.416244,"lat":39.920215,"count":91},
					{"lng":116.41929,"lat":39.915908,"count":54},
					{"lng":116.422116,"lat":39.919658,"count":21},
					{"lng":116.4183,"lat":39.925015,"count":15},
					{"lng":116.421969,"lat":39.913527,"count":3},
					{"lng":116.422936,"lat":39.921854,"count":24},
					{"lng":116.41905,"lat":39.929217,"count":12},
					{"lng":116.424579,"lat":39.914987,"count":57},
					{"lng":116.42076,"lat":39.915251,"count":70},
					{"lng":116.425867,"lat":39.918989,"count":8}];
				   
					if(!isSupportCanvas()){
						alert('热力图目前只支持有canvas支持的浏览器,您所使用的浏览器不能使用热力图功能~')
					}
					//详细的参数,可以查看heatmap.js的文档 https://github.com/pa7/heatmap.js/blob/master/README.md
					//参数说明如下:
					/* visible 热力图是否显示,默认为true
					 * opacity 热力的透明度,1-100
					 * radius 势力图的每个点的半径大小   
					 * gradient  {JSON} 热力图的渐变区间 . gradient如下所示
					 *	{
							.2:'rgb(0, 255, 255)',
							.5:'rgb(0, 110, 255)',
							.8:'rgb(100, 0, 255)'
						}
						其中 key 表示插值的位置, 0~1. 
							value 为颜色值. 
					 */
					heatmapOverlay = new BMapLib.HeatmapOverlay({"radius":20});
					map.addOverlay(heatmapOverlay);
					heatmapOverlay.setDataSet({data:points,max:100});
					//是否显示热力图
					function openHeatmap(){
						heatmapOverlay.show();
					}
					function closeHeatmap(){
						heatmapOverlay.hide();
					}
					openHeatmap();
					function setGradient(){
						/*格式如下所示:
						{
							0:'rgb(102, 255, 0)',
							.5:'rgb(255, 170, 0)',
							1:'rgb(255, 0, 0)'
						}*/
						var gradient = {};
						var colors = document.querySelectorAll("input[type='color']");
						colors = [].slice.call(colors,0);
						colors.forEach(function(ele){
							gradient[ele.getAttribute("data-key")] = ele.value; 
						});
						heatmapOverlay.setOptions({"gradient":gradient});
					}
					//判断浏览区是否支持canvas
					function isSupportCanvas(){
						var elem = document.createElement('canvas');
						return !!(elem.getContext && elem.getContext('2d'));
					}
					
				}
				
				window.onresize = function() {
					myChart1.resize()
					myChart2.resize()
					myChart3.resize()
				}
			
			}
			
			
			// 异步请求新闻信息
	        reqPub()
	        function reqPub() {
	            $.ajax({
	                type : "GET", //提交方式
	                url : "http://localhost:8080/pub/listPubs",//路径
	                // async: false,
	                data : {
	                    page: 1
	                    ,limit: 10000
	                },//数据，这里使用的是Json格式进行传输
	                success: function(result) {//返回数据根据结果进行相应的处理
	                    if (result) {
	                        vm.pub = result.data
	                    } else {
	                        console.info("出错")
	                    }
	                },
	            });
	        }
			
			/*** ******************************* Vue开始 踩坑3：vue需要放在window.onload函数外，才不会对地图上的控件的点击事件不会造成影响 */
			var vm;
			initVue()
			function initVue() {
				// 字符串转时间过滤器
				Vue.filter('dateStr', function (timestamp) {
					var d = new Date(timestamp);    //根据时间戳生成的时间对象
					var date =
						(d.getMonth() + 1) + "-" +
						(d.getDate()) + " " +
						(d.getHours()) + ":" +
						(d.getMinutes()) + ":" +
						(d.getSeconds());
					return date
				})
				 // 字符串转日期过滤器
	            Vue.filter('dateStr1', function (timestamp) {
	                var d;
	                if(timestamp) {
	                    d = new Date(timestamp );    //根据时间戳生成的时间对象
	                } else {
	                    d = new Date();
	                }
	                var date =
	                    (d.getFullYear())+"年"+
	                    (d.getMonth() + 1) + "月" +
	                    (d.getDate()) + "日"
	                return date
	            })
				vm = new Vue({
					el: '#main',
					data: {
						isFullScreen: true,
						pub: []
					},
					methods: {
						fullScreen() {
							console.log(this.isFullScreen)
							if(this.isFullScreen) {
								var el = document.documentElement;
								var rfs = el.requestFullScreen || el.webkitRequestFullScreen || el.mozRequestFullScreen || el.msRequestFullscreen;
								if(typeof rfs != "undefined" && rfs) {
									rfs.call(el);
								}else{
									getMsg("浏览器不支持全屏调用，请使用其他浏览器或按F11键切换全屏！");
									return;
								}
								this.isFullScreen = false
							} else {
								if(document.exitFullscreen) {
									document.exitFullscreen();
								} else if(document.mozCancelFullScreen) {
									document.mozCancelFullScreen();
								} else if(document.webkitCancelFullScreen) {
									document.webkitCancelFullScreen();
								} else if(document.msExitFullscreen) {
									document.msExitFullscreen();
								}
								if(typeof cfs != "undefined" && cfs) {
									cfs.call(el);
								}
								this.isFullScreen = true
							}
						},
						
					},
					
					// 钩子函数
					mounted: function () {
					
					},
					// 监听属性
					watch: {
						
					}
				});
					
			}
			
			/** ******************************* Vue完 ***************************************/
			
			
		</script>
		
	</body>
</html>
